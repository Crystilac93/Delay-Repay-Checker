<!DOCTYPE html>
<html lang="en-GB"> <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rail Delay Finder</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><text y='14' font-size='14'>ðŸš†</text></svg>" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Lighter slate-50 for subtle gradient */
            background-image: linear-gradient(to bottom, #f8fafc, #f1f5f9); /* slate-50 to slate-100 */
        }
        /* Radial Progress Loader */
        .progress-ring {
            transition: stroke-dashoffset 0.35s linear; /* Smoother transition */
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        .text-danger { color: #ef4444; font-weight: 600; } /* red-500 */
        .text-warning { color: #f59e0b; } /* amber-500 */
        .text-success { color: #22c55e; } /* green-500 */

        /* Checkbox & Radio Styles */
        input[type="checkbox"], input[type="radio"] { color: #10b981; } /* emerald-500 */
        input[type="checkbox"]:focus, input[type="radio"]:focus { ring: #10b981; border-color: #10b981;} /* emerald-500 */
        
        /* Time Input Style */
        input[type="time"] {
             -webkit-appearance: none; appearance: none;
             background-color: #fff;
             border: 1px solid #d1d5db;
             border-radius: 0.375rem;
             padding: 0.4rem 0.75rem;
             font-size: 0.875rem;
             box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        }
         input[type="time"]:focus {
             outline: 2px solid transparent; outline-offset: 2px;
             border-color: #10b981;
             box-shadow: 0 0 0 1px #10b981;
         }

        /* Input with Icon Styles */
        .icon-input-container { position: relative; }
        .icon-input-container .icon { position: absolute; left: 0.75rem; top: 50%; transform: translateY(-50%); color: #9ca3af; pointer-events: none; }
        .icon-input-container input, .icon-input-container .input-like { padding-left: 2.5rem; }

        /* Ticket Price Input Styles */
        #ticket-price-settings {
             appearance: textfield; background-color: #fff; border-width: 1px; border-color: #d1d5db; border-radius: 0.375rem; padding-top: 0.5rem; padding-right: 0.75rem; padding-bottom: 0.5rem; font-size: 1rem; line-height: 1.5rem; box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); }
        #ticket-price-settings:focus {
             outline: 2px solid transparent; outline-offset: 2px; --tw-ring-color: #10b981; border-color: var(--tw-ring-color); box-shadow: 0 0 0 1px var(--tw-ring-color); }
        #ticket-price-settings::-webkit-outer-spin-button, #ticket-price-settings::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        #ticket-price-settings[type=number] { -moz-appearance: textfield; }

        /* REPLACED: kpi-card-large styles (no longer needed) */
        
        /* Small KPI Widget (NEW FILLED STYLE) */
        .kpi-widget-small {
            background-color: #10b981; /* Default: emerald-500 */
            color: #ffffff;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); /* Match large card shadow */
            padding: 1rem; /* p-4 */
            display: flex;
            align-items: center;
        }
        .kpi-widget-icon {
            flex-shrink: 0;
            padding: 0.6rem;
            border-radius: 9999px;
            margin-right: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background-color: rgba(255, 255, 255, 0.15); /* Transparent white */
        }
        /* Icon SVG color */
        .kpi-widget-icon svg {
            color: #ffffff; /* White icon */
        }
        .kpi-widget-content { 
            flex-grow: 1;
            /* NEW: Make label and value horizontal */
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }
        .kpi-widget-label { 
            font-size: 0.75rem; /* text-xs */ 
            font-weight: 600; 
            color: #d1fae5; /* Default: emerald-100 */
            text-transform: uppercase; 
            letter-spacing: 0.05em;
            /* NEW: Remove margin */
        }
        .kpi-widget-value { 
            font-size: 1.875rem; /* text-3xl */ 
            line-height: 2.25rem;
            font-weight: 700; 
            color: #ffffff; /* White text */
            /* NEW: Remove margin */
        }
        
        /* Remove default delay text colors */
        .kpi-widget-value.is-delayed,
        .kpi-widget-value.is-delayed-medium,
        .kpi-widget-value.is-delayed-high,
        .kpi-widget-value.is-cancelled { 
            color: #ffffff; /* All values are white now */
        }

        /* --- Color Variants --- */
        /* We need to apply these to the .kpi-widget-small element */

        /* Amber (15-29) */
        .kpi-widget-small.variant-amber {
            background-color: #f59e0b; /* amber-500 */
        }
        .kpi-widget-small.variant-amber .kpi-widget-label { color: #fef3c7; /* amber-100 */ }

        /* Orange (30-59) */
        .kpi-widget-small.variant-orange {
            background-color: #f97316; /* orange-500 */
        }
        .kpi-widget-small.variant-orange .kpi-widget-label { color: #ffedd5; /* orange-100 */ }

        /* Red (60-119) */
        .kpi-widget-small.variant-red {
            background-color: #ef4444; /* red-500 */
        }
        .kpi-widget-small.variant-red .kpi-widget-label { color: #fee2e2; /* red-100 */ }

        /* Red-700 (120+ & Cancelled) */
        .kpi-widget-small.variant-red-dark {
            background-color: #b91c1c; /* red-700 */
        }
        .kpi-widget-small.variant-red-dark .kpi-widget-label { color: #fecaca; /* red-200 */ }

        /* Slate (for 'Other' section) */
        .kpi-widget-small.variant-slate {
            background-color: #475569; /* slate-600 */
        }
        .kpi-widget-small.variant-slate .kpi-widget-label { color: #cbd5e1; /* slate-300 */ }
        .kpi-widget-small.variant-slate .kpi-widget-icon { background-color: rgba(0, 0, 0, 0.15); } /* Differentiate icon bg */
        

        /* Skeleton Loader Styles */
        .skeleton { background-color: #e5e7eb; border-radius: 0.25rem; animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 50% { opacity: .5; } }
        .skeleton-kpi-large { height: 80px; /* Approx height of new large kpi card */ }
        .skeleton-kpi-small { height: 80px; /* Approx height of small kpi widget */ }
        .skeleton-table-head { height: 49px; margin-bottom: 0.5rem; }
        .skeleton-table-row { height: 65px; margin-bottom: 0.5rem; }
        .skeleton-table-footer { height: 57px; margin-top: 0.5rem; }

        /* Transitions */
        .transition-all { transition-property: all; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 300ms; }
        .opacity-0 { opacity: 0; }
        .opacity-100 { opacity: 1; }
        .translate-x-full { transform: translateX(100%); }
        .translate-x-0 { transform: translateX(0); }

        /* Table: Removed Zebra-striping, added hover */
         #results-table-office tbody tr:hover,
         #results-table-other tbody tr:hover { 
             background-color: #f9fafb; /* gray-50 */ 
         }

         /* Settings Panel Styles */
        #settings-panel { position: fixed; top: 0; right: 0; bottom: 0; width: 320px; background-color: white; box-shadow: -2px 0 10px rgba(0,0,0,0.1); z-index: 50; padding: 0; /* Padding removed for full height scroll */ overflow-y: auto; display: flex; flex-direction: column; }
        #settings-header { flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; border-bottom: 1px solid #e5e7eb; }
        #settings-content { flex-grow: 1; padding: 1.5rem; space-y-6; overflow-y: auto; }
        #settings-footer { flex-shrink: 0; padding: 1.5rem; border-top: 1px solid #e5e7eb; background-color: #f9fafb; }
        #settings-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.5); z-index: 40; }

        /* Segmented Control Styles */
        .segmented-control { display: inline-flex; border-radius: 0.375rem; /* rounded-md */ overflow: hidden; border: 1px solid #d1d5db; /* border-gray-300 */ width: 100%; /* Make container full width */}
        .segmented-control input[type="radio"] { position: absolute; opacity: 0; width: 0; height: 0; }
        .segmented-control label {
            flex: 1; /* Make labels take equal space */
            text-align: center; /* Center text */
            padding: 0.5rem 1rem; /* py-2 px-4 */
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            color: #4b5563; /* text-gray-600 */
            background-color: #fff; /* bg-white */
            cursor: pointer;
            border-right: 1px solid #d1d5db; /* border-gray-300 */
            transition: background-color 0.2s ease, color 0.2s ease;
         }
        .segmented-control label:last-child { border-right: none; }
        .segmented-control input[type="radio"]:checked + label { background-color: #ecfdf5; /* emerald-50 */ color: #059669; /* emerald-600 */ }
        .segmented-control label:hover { background-color: #f9fafb; /* gray-50 */ }
        .segmented-control input[type="radio"]:focus + label { /* Optional: Add focus style */ box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.3); z-index: 10; }

        /* Ensure week commencing label occupies space */
        #week-commencing-label {
            min-height: 1.25rem; /* approx h-5 */
        }

        /* Autocomplete Styles */
        .autocomplete-container { position: relative; }
        .autocomplete-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 60; /* Above settings panel overlay */
            background-color: white;
            border: 1px solid #d1d5db; /* gray-300 */
            border-top: none;
            border-radius: 0 0 0.375rem 0.375rem; /* rounded-b-md */
            max-height: 150px;
            overflow-y: auto;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); /* shadow-md */
        }
        .autocomplete-item { padding: 0.5rem 0.75rem; font-size: 0.875rem; cursor: pointer; color: #374151; }
        .autocomplete-item:hover, .autocomplete-item.is-active { background-color: #ecfdf5; color: #059669; }
        .autocomplete-item strong { font-weight: 600; }

        /* NEW: Toggle Switch Styles */
        .toggle-bg:after { content: ''; position: absolute; top: 2px; left: 2px; background-color: white; border-radius: 9999px; width: 1.25rem; /* h-5 */ height: 1.25rem; /* w-5 */ transition: all 0.2s ease-in-out; }
        input:checked + .toggle-bg { background-color: #10b981; /* emerald-500 */ }
        input:checked + .toggle-bg:after { transform: translateX(100%); left: calc(100% - 2px); transform: translateX(-100%); }

    </style>
</head>
<body class="min-h-screen">

    <nav class="bg-emerald-600 shadow-md"> <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <span class="text-3xl" role="img" aria-label="Train">ðŸš†</span>
                        <span class="ml-3 text-xl font-bold text-white">DelayRepay Finder</span>
                    </div>
                </div>
                <div class="flex items-center">
                     <button id="settings-toggle-button" type="button" class="p-2 rounded-md text-emerald-100 hover:text-white hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white">
                        <span class="sr-only">Open settings</span>
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                     </button>
                </div>
            </div>
        </div>
    </nav>

     <div id="settings-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden opacity-0 transition-opacity duration-300 ease-in-out"></div>
    <div id="settings-panel" class="fixed top-0 right-0 bottom-0 w-80 bg-white shadow-xl z-50 transform translate-x-full transition-all duration-300 ease-in-out flex flex-col">
        
        <div id="settings-header">
            <h2 class="text-xl font-semibold text-gray-800">Settings</h2>
            <button id="close-settings-button" type="button" class="p-1 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-emerald-500">
                <span class="sr-only">Close settings</span>
                <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
        </div>
        
        <div id="settings-content" class="flex-grow">
             <div class="border border-gray-200 rounded-lg p-4">
                 <h3 class="text-md font-medium text-gray-900 mb-3">Ticket Settings</h3>
                 <div>
                    <label for="ticket-price-settings" class="block text-sm font-medium text-gray-700 mb-1">Annual Ticket Price (Â£)</label>
                    <div class="icon-input-container">
                         <span class="icon text-gray-400 font-semibold">Â£</span>
                         <input type="text" id="ticket-price-settings" inputmode="decimal" value="7437.92" class="input-like block w-full" required>
                    </div>
                 </div>
             </div>
              <div class="border border-gray-200 rounded-lg p-4">
                 <h3 class="text-md font-medium text-gray-900 mb-4">Journey Settings</h3>
                 <div class="space-y-4">
                     <div class="autocomplete-container">
                        <label for="setting-outbound-from" class="block text-xs font-medium text-gray-600">Outbound From</label>
                        <input type="text" id="setting-outbound-from" data-crs-code="DID" value="Didcot Parkway [DID]" autocomplete="off" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-emerald-500 focus:ring-emerald-500 text-sm">
                        <div class="autocomplete-results hidden" id="results-setting-outbound-from"></div>
                        <input type="hidden" id="setting-outbound-from-code" value="DID"> </div>
                     <div class="autocomplete-container">
                        <label for="setting-outbound-to" class="block text-xs font-medium text-gray-600">Outbound To</label>
                        <input type="text" id="setting-outbound-to" data-crs-code="PAD" value="London Paddington [PAD]" autocomplete="off" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-emerald-500 focus:ring-emerald-500 text-sm">
                         <div class="autocomplete-results hidden" id="results-setting-outbound-to"></div>
                        <input type="hidden" id="setting-outbound-to-code" value="PAD">
                     </div>
                     <div class="autocomplete-container">
                        <label for="setting-inbound-from" class="block text-xs font-medium text-gray-600">Inbound From</label>
                        <input type="text" id="setting-inbound-from" data-crs-code="PAD" value="London Paddington [PAD]" autocomplete="off" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-emerald-500 focus:ring-emerald-500 text-sm">
                         <div class="autocomplete-results hidden" id="results-setting-inbound-from"></div>
                         <input type="hidden" id="setting-inbound-from-code" value="PAD">
                     </div>
                     <div class="autocomplete-container">
                        <label for="setting-inbound-to" class="block text-xs font-medium text-gray-600">Inbound To</label>
                        <input type="text" id="setting-inbound-to" data-crs-code="DID" value="Didcot Parkway [DID]" autocomplete="off" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-emerald-500 focus:ring-emerald-500 text-sm">
                         <div class="autocomplete-results hidden" id="results-setting-inbound-to"></div>
                         <input type="hidden" id="setting-inbound-to-code" value="DID">
                     </div>
                 </div>
             </div>
             </div>
        
        <div id="settings-footer">
             <p class="text-xs text-gray-500 mb-3">Settings are saved in your browser.</p>
             <div class="flex space-x-3">
                <button type="button" id="save-settings-button" class="flex-1 bg-emerald-600 text-white py-2 px-4 rounded-md shadow-sm hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 text-sm font-medium">Save</button>
                <button type="button" id="load-settings-button" class="flex-1 bg-slate-100 text-slate-700 py-2 px-4 rounded-md shadow-sm hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 text-sm font-medium">Load</button>
             </div>
        </div>
    </div>


    <main class="max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8">

        <div class="bg-white rounded-xl shadow-lg p-6 sm:p-8">
            <h1 class="text-2xl font-semibold text-gray-900 mb-1">Journey Search</h1>
            <p class="text-gray-500 text-sm mb-8">
                Find weekday services to analyse delays and potential compensation.
            </p>

            <form id="search-form" class="space-y-8">

                <div class="border border-gray-200 rounded-lg p-5">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Search Period</h3>
                    <div class="flex flex-col sm:flex-row sm:items-end sm:gap-6">
                        <fieldset class="mb-4 sm:mb-0 sm:w-auto">
                             <legend class="block text-sm font-medium text-gray-700 mb-2">Search by:</legend>
                             <div class="segmented-control">
                                <input id="search-type-week" name="search-type" type="radio" value="week" checked>
                                <label for="search-type-week">Week</label>
                                <input id="search-type-day" name="search-type" type="radio" value="day">
                                <label for="search-type-day">Day</label>
                            </div>
                        </fieldset>

                        <div class="flex-grow">
                            <label for="date-picker" id="date-picker-label" class="block text-sm font-medium text-gray-700 mb-1">Select Week</label>
                            <div class="icon-input-container">
                                <svg class="icon h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" /></svg>
                                <input type="date" id="date-picker" class="icon-input block w-full rounded-md border-gray-300 shadow-sm focus:border-emerald-500 focus:ring-emerald-500" required>
                            </div>
                            <p id="week-commencing-label" class="text-xs text-gray-500 mt-1 min-h-[1.25rem]">w/c ...</p>
                        </div>
                    </div>
                </div>


                 <div id="days-in-office-group" class="border border-gray-200 rounded-lg p-5">
                    <h3 class="text-lg font-medium text-gray-900 mb-1">Days in Office</h3>
                    <p class="text-sm text-gray-500 mb-4">Select the days you travelled.</p>
                    <fieldset>
                        <legend class="sr-only">Days in Office</legend>
                        <div class="flex flex-wrap gap-x-6 gap-y-4">
                            <div class="flex items-center">
                                <input id="day-mon" name="daysInOffice" type="checkbox" checked value="1" class="h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                                <label for="day-mon" class="ml-2 block text-sm font-medium text-gray-700">Monday</label>
                            </div>
                            <div class="flex items-center">
                                <input id="day-tue" name="daysInOffice" type="checkbox" checked value="2" class="h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                                <label for="day-tue" class="ml-2 block text-sm font-medium text-gray-700">Tuesday</label>
                            </div>
                            <div class="flex items-center">
                                <input id="day-wed" name="daysInOffice" type="checkbox" checked value="3" class="h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                                <label for="day-wed" class="ml-2 block text-sm font-medium text-gray-700">Wednesday</label>
                            </div>
                            <div class="flex items-center">
                                <input id="day-thu" name="daysInOffice" type="checkbox" checked value="4" class="h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500">
                                <label for="day-thu" class="ml-2 block text-sm font-medium text-gray-700">Thursday</label>
                            </div>
                            <div class="flex items-center">
                                <input id="day-fri" name="daysInOffice" type="checkbox" value="5" class="h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"> <label for="day-fri" class="ml-2 block text-sm font-medium text-gray-700">Friday</label>
                            </div>
                        </div>
                    </fieldset>
                </div>


                <div class="border border-gray-200 rounded-lg p-5">
                     <h3 class="text-lg font-medium text-gray-900 mb-4">Journey Times</h3>
                    <div class="mb-6">
                        <h4 class="flex justify-between items-center mb-1">
                            <span class="text-md font-medium text-gray-800">
                                Outbound (Work) <span id="outbound-stations-label" class="text-xs text-gray-500 font-normal"></span>
                            </span>
                            <button type="button" id="change-outbound-journey" class="text-xs font-medium text-emerald-600 hover:text-emerald-800 focus:outline-none">Change</button>
                        </h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pt-2">
                            <div>
                                <label for="from-time-outbound" class="block text-sm font-medium text-gray-700">From Time</label>
                                <input type="time" id="from-time-outbound" value="07:00" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-emerald-500 focus:ring-emerald-500 text-sm">
                            </div>
                            <div>
                                <label for="to-time-outbound" class="block text-sm font-medium text-gray-700">To Time</label>
                                <input type="time" id="to-time-outbound" value="07:30" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-emerald-500 focus:ring-emerald-500 text-sm">
                            </div>
                        </div>
                    </div>
                    <div>
                         <h4 class="flex justify-between items-center mb-1">
                            <span class="text-md font-medium text-gray-800">
                                Inbound (Home) <span id="inbound-stations-label" class="text-xs text-gray-500 font-normal"></span>
                            </span>
                             <button type="button" id="change-inbound-journey" class="text-xs font-medium text-emerald-600 hover:text-emerald-800 focus:outline-none">Change</button>
                        </h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pt-2">
                             <div>
                                <label for="from-time-inbound" class="block text-sm font-medium text-gray-700">From Time</label>
                                <input type="time" id="from-time-inbound" value="17:00" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-emerald-500 focus:ring-emerald-500 text-sm">
                            </div>
                            <div>
                                <label for="to-time-inbound" class="block text-sm font-medium text-gray-700">To Time</label>
                                <input type="time" id="to-time-inbound" value="17:30" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-emerald-500 focus:ring-emerald-500 text-sm">
                            </div>
                        </div>
                    </div>
                </div>

                 <div class="pt-6 flex justify-between items-center min-h-[4rem]"> <div id="status-loading-container" class="flex items-center flex-grow mr-4"> <div id="loading" class="hidden items-center">
                            <div class="relative w-8 h-8">
                                <svg class="w-full h-full" viewBox="0 0 36 36"><path class="text-gray-200" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3.8" /><path id="progress-ring" class="text-emerald-500 progress-ring" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3.8" stroke-dasharray="100, 100" stroke-dashoffset="100" /></svg>
                            </div>
                            <span id="loading-message" class="ml-2 text-sm text-gray-600">Fetching...</span>
                        </div>
                         <div id="status-message" class="text-sm text-left"></div> </div>

                    <button type="submit" id="submit-button" class="bg-emerald-600 text-white py-2.5 px-6 rounded-md shadow-sm hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 transition duration-150 ease-in-out flex-shrink-0"> Check Performance
                    </button>
                </div>
            </form>

             <div id="skeleton-loader" class="mt-10 hidden space-y-8">
                 <div class="space-y-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4 skeleton"></div>
                    <div class="space-y-6">
                        <div class="skeleton skeleton-kpi-large"></div>
                        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4">
                            <div class="skeleton skeleton-kpi-small"></div>
                            <div class="skeleton skeleton-kpi-small"></div>
                            <div class="skeleton skeleton-kpi-small"></div>
                            <div class="skeleton skeleton-kpi-small"></div>
                            <div class="skeleton skeleton-kpi-small"></div>
                        </div>
                    </div>
                </div>
                 <div class="space-y-4">
                     <div class="h-4 bg-gray-200 rounded w-1/3 skeleton"></div>
                     <div class="bg-white rounded-lg shadow-lg overflow-hidden p-4 space-y-2"> <div class="skeleton skeleton-table-head"></div> <div class="skeleton skeleton-table-row"></div> <div class="skeleton skeleton-table-row"></div> <div class="skeleton skeleton-table-row"></div> <div class="skeleton skeleton-table-footer"></div> </div>
                 </div>
                 <div class="space-y-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4 skeleton"></div>
                     <div class="space-y-6">
                        <div class="skeleton skeleton-kpi-large"></div>
                        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4">
                            <div class="skeleton skeleton-kpi-small"></div>
                            <div class="skeleton skeleton-kpi-small"></div>
                            <div class="skeleton skeleton-kpi-small"></div>
                            <div class="skeleton skeleton-kpi-small"></div>
                            <div class="skeleton skeleton-kpi-small"></div>
                        </div>
                    </div>
                </div>
                 <div class="space-y-4">
                     <div class="h-4 bg-gray-200 rounded w-1/3 skeleton"></div>
                     <div class="bg-white rounded-lg shadow-lg overflow-hidden p-4 space-y-2"> <div class="skeleton skeleton-table-head"></div> <div class="skeleton skeleton-table-row"></div> <div class="skeleton skeleton-table-row"></div> <div class="skeleton skeleton-table-footer"></div> </div>
                 </div>
            </div>


        </div>

        <div id="results-area" class="mt-10 opacity-0 transition-opacity duration-500 ease-in-out">

            <h2 id="in-office-summary-heading" class="text-xl font-semibold text-gray-900 mb-4">In-Office Summary</h2>
            <div class="space-y-6"> <div class="kpi-widget-small p-5"> <div class="kpi-widget-content"> <dt class="kpi-widget-label text-base">Total Est. Refund</dt> <dd id="total-refund-kpi-office" class="kpi-widget-value text-4xl">Â£0.00</dd> </div>
                </div>

                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4">
                    <div class="kpi-widget-small variant-amber">
                        <div class="kpi-widget-icon">
                            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Short Delay</dt>
                            <dd id="delayed-15-29-office" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                    <div class="kpi-widget-small variant-orange">
                        <div class="kpi-widget-icon">
                            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Medium Delay</dt>
                            <dd id="delayed-30-59-office" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                    <div class="kpi-widget-small variant-red">
                        <div class="kpi-widget-icon">
                             <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Long Delay</dt>
                            <dd id="delayed-60-119-office" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                     <div class="kpi-widget-small variant-red-dark">
                        <div class="kpi-widget-icon">
                             <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Severe Delay</dt>
                            <dd id="delayed-120-plus-office" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                    <div class="kpi-widget-small variant-red-dark">
                        <div class="kpi-widget-icon">
                             <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Cancelled</dt>
                            <dd id="cancelled-kpi-office" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-8 bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                    <h2 id="in-office-table-heading" class="text-xl font-semibold text-gray-900">In-Office Journey Details</h2>
                    <div class="flex items-center">
                        <span class="text-sm font-medium text-gray-600 mr-3">Show delays only</span>
                        <label for="toggle-office-delays" class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="toggle-office-delays" class="sr-only">
                            <div class="toggle-bg w-11 h-6 bg-gray-200 rounded-full transition-colors ease-in-out duration-200"></div>
                        </label>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full" id="results-table-office">
                        <thead class="bg-slate-50">
                            <tr>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Journey</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sch. Dep.</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sch. Arr.</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actual Arr.</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Delay</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Refund</th>
                            </tr>
                        </thead>
                        <tbody id="results-body-office" class="bg-white divide-y divide-gray-200">
                            </tbody>
                    </table>
                     <p id="no-office-results" class="hidden text-center text-gray-500 py-6 text-sm">No journeys found for selected in-office days.</p>
                </div>
                 </div>


            <h2 id="other-weekdays-summary-heading" class="text-xl font-semibold text-gray-900 mt-10 mb-4">Other Weekdays Summary</h2>
             <div id="other-weekdays-kpi-grid" class="space-y-6"> <div class="kpi-widget-small variant-slate p-5"> <div class="kpi-widget-content"> <dt class="kpi-widget-label text-base">Total Est. Refund</dt> <dd id="total-refund-kpi-other" class="kpi-widget-value text-4xl">Â£0.00</dd> </div>
                </div>
                
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4">
                     <div class="kpi-widget-small variant-slate">
                        <div class="kpi-widget-icon">
                             <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Cancelled</dt>
                            <dd id="cancelled-kpi-other" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                    <div class="kpi-widget-small variant-slate">
                        <div class="kpi-widget-icon">
                            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Short Delay</dt>
                            <dd id="delayed-15-29-other" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                    <div class="kpi-widget-small variant-slate">
                        <div class="kpi-widget-icon">
                            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Medium Delay</dt>
                            <dd id="delayed-30-59-other" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                    <div class="kpi-widget-small variant-slate">
                        <div class="kpi-widget-icon">
                             <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Long Delay</dt>
                            <dd id="delayed-60-119-other" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                     <div class="kpi-widget-small variant-slate">
                        <div class="kpi-widget-icon">
                             <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
                        </div>
                         <div class="kpi-widget-content">
                            <dt class="kpi-widget-label">Severe Delay</dt>
                            <dd id="delayed-120-plus-other" class="kpi-widget-value">0</dd>
                        </div>
                    </div>
                </div>
            </div>


            <div id="other-weekdays-table-card" class="mt-8 bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                    <h2 class="text-xl font-semibold text-gray-900">Other Weekday Journey Details</h2>
                     <div class="flex items-center">
                        <span class="text-sm font-medium text-gray-600 mr-3">Show delays only</span>
                        <label for="toggle-other-delays" class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="toggle-other-delays" class="sr-only">
                            <div class="toggle-bg w-11 h-6 bg-gray-200 rounded-full transition-colors ease-in-out duration-200"></div>
                        </label>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full" id="results-table-other">
                         <thead class="bg-slate-50">
                            <tr>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Journey</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sch. Dep.</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sch. Arr.</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actual Arr.</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Delay</th>
                                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Refund</th>
                            </tr>
                        </thead>
                        <tbody id="results-body-other" class="bg-white divide-y divide-gray-200">
                            </tbody>
                    </table>
                    <p id="no-other-results" class="hidden text-center text-gray-500 py-6 text-sm">No journeys found for other weekdays.</p>
                </div>
                </div>

            <div id="error-report-area" class="mt-8 opacity-0 transition-opacity duration-500 ease-in-out hidden">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="px-6 py-4 border-b border-red-200 bg-red-50">
                        <h2 class="text-xl font-semibold text-red-800">Data Collection Issues</h2>
                    </div>
                    <div class="p-6">
                        <p class="text-sm text-gray-700 mb-4">
                            The following requests failed due to API rate limits. The data for these items may be incomplete or missing:
                        </p>
                        <ul id="error-list" class="list-disc list-inside space-y-1 text-sm text-red-700">
                            </ul>
                    </div>
                </div>
            </div>


        </div>

    </main>


	<script src="config.js"></script>
	
    <script src="station_data.js"></script>

    <script src="app.js"></script> 
	
</body>
</html>
